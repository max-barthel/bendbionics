echo "ğŸ” Validating commit message..."

# Check if commitlint is available
if ! command -v npx >/dev/null 2>&1; then
  echo "âš ï¸  npx not available - skipping commit message validation"
  exit 0
fi

# Check if this is an auto-generated commit message
if grep -q "auto\|generated\|AI\|assistant" "$1" 2>/dev/null; then
  echo "ğŸ¤– Auto-generated commit detected - using relaxed validation"
  npx --no -- commitlint --edit "$1" 2>/dev/null || {
    echo "âš ï¸  Auto-generated message doesn't follow conventional format, but allowing commit"
    echo "ğŸ’¡ Consider using 'npm run commit' for better commit messages in the future"
    exit 0
  }
else
  echo "ğŸ‘¤ Manual commit detected - using standard validation"
  if ! npx --no -- commitlint --edit "$1" 2>/dev/null; then
    echo "âŒ Commit message validation failed."
    echo "ğŸ’¡ Use 'npm run commit' for guided commit creation."
    exit 1
  fi
fi

echo "âœ… Commit message validation passed!"
