---
description: Testing patterns focused on real user value - Vitest for frontend, pytest for backend, minimal mocking
globs: ["frontend/src/**/*.test.tsx", "frontend/src/**/*.test.ts", "frontend/e2e/**/*.spec.ts", "backend/tests/**/*.py"]
alwaysApply: false
---

# Testing Patterns

## Core Principle: Test What Users Actually Use

**DO Test**: Core user flows, critical APIs, real bugs
**DON'T Test**: Edge cases, implementation details, perfect coverage

## Frontend Testing (Vitest + React Testing Library)

```tsx
import { render, screen, fireEvent } from "@testing-library/react";
import { describe, it, expect, vi } from "vitest";

describe("ComponentName", () => {
  it("renders correctly", () => {
    render(<ComponentName prop="value" />);
    expect(screen.getByText("Expected")).toBeInTheDocument();
  });

  it("handles interactions", () => {
    const handler = vi.fn();
    render(<ComponentName onAction={handler} />);
    fireEvent.click(screen.getByRole("button"));
    expect(handler).toHaveBeenCalled();
  });
});
```

## Backend Testing (pytest + FastAPI TestClient)

```python
from fastapi.testclient import TestClient
from app.main import app

client = TestClient(app)

def test_endpoint_success():
    response = client.post("/kinematics", json={
        "bending_angles": [0.5, 0.3],
        "rotation_angles": [0.0, 0.0],
        "backbone_lengths": [0.1, 0.1],
        "coupling_lengths": [0.02, 0.02, 0.02],
        "discretization_steps": 10
    })
    assert response.status_code == 200
    assert response.json()["success"] is True
    assert "data" in response.json()

def test_validation_error():
    response = client.post("/kinematics", json={"invalid": "data"})
    assert response.status_code == 422
```

## Test Organization

- **Frontend**: `src/**/*.test.tsx` (alongside components), `e2e/*.spec.ts` (Playwright)
- **Backend**: `tests/test_*.py` (critical APIs only)

## Guidelines

- **Minimal Mocking**: Only external APIs, use real internal code
- **Real Scenarios**: Test actual user workflows, not edge cases
- **Quick Tests**: Fast feedback, 60-70% coverage of critical paths
- **Simple Fixtures**: Keep test data realistic and minimal
